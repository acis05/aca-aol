<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ACA-AOL ‚Äî Import Excel to Accurate Online</title>

  <!-- Elegant modern font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fff7ed;           /* orange-50 */
      --card:#ffffff;
      --text:#111827;         /* slate-900 */
      --muted:#4b5563;        /* gray-600 */
      --muted2:#6b7280;       /* gray-500 */
      --stroke:rgba(17,24,39,.10);
      --shadow: 0 18px 60px rgba(17,24,39,.10);

      --brand:#f97316;        /* orange-500 */
      --brand2:#fb923c;       /* orange-400 */
      --brand3:#ea580c;       /* orange-600 */
      --green:#16a34a;
      --chip:#fff1e6;
      --chipText:#9a3412;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:"Plus Jakarta Sans", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 10% 0%, rgba(249,115,22,.16), transparent 60%),
        radial-gradient(900px 600px at 95% 10%, rgba(234,88,12,.12), transparent 55%),
        radial-gradient(900px 700px at 35% 110%, rgba(251,146,60,.18), transparent 60%),
        linear-gradient(180deg, #fff7ed, #fff);
      letter-spacing:-0.01em;
    }

    a{ color:inherit; text-decoration:none; }
    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:28px 18px 44px;
    }

    /* Top bar */
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:22px;
    }
    .brandRow{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 200px;
    }
    .logo{
      width:220px;
      max-width: 65vw;
      height:auto;
      display:block;
      filter: drop-shadow(0 10px 22px rgba(234,88,12,.12));
    }
    .topRight{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.75);
      backdrop-filter: blur(8px);
      border-radius:999px;
      font-size:13px;
      color:var(--muted);
    }
    .pill strong{ color:var(--text); font-weight:700; }
    .dot{
      width:8px; height:8px; border-radius:999px;
      background:var(--green);
      box-shadow: 0 0 0 4px rgba(22,163,74,.12);
    }

    /* Hero */
    .hero{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:18px;
      align-items:stretch;
      margin-top:8px;
    }
    @media (max-width: 900px){
      .hero{ grid-template-columns: 1fr; }
      .top{ flex-direction:column; align-items:flex-start; }
      .topRight{ justify-content:flex-start; }
    }

    .card{
      background:rgba(255,255,255,.86);
      border:1px solid var(--stroke);
      border-radius:22px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .heroLeft{
      padding:26px 26px 22px;
      position:relative;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background:var(--chip);
      color:var(--chipText);
      font-weight:700;
      font-size:13px;
      border:1px solid rgba(249,115,22,.18);
      margin-bottom:14px;
    }
    .badge span{
      display:inline-block;
      width:8px; height:8px; border-radius:999px;
      background:var(--brand);
    }

    h1{
      margin:0 0 10px;
      font-size:44px;
      line-height:1.08;
      letter-spacing:-0.045em;
    }
    .grad{
      background: linear-gradient(90deg, var(--brand3), var(--brand), #22c55e);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .sub{
      margin:0 0 18px;
      font-size:16px;
      line-height:1.65;
      color:var(--muted);
      font-weight:500;
      max-width: 62ch;
    }

    .points{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin:14px 0 18px;
    }
    @media (max-width: 520px){
      .points{ grid-template-columns: 1fr; }
      h1{ font-size:36px; }
    }
    .pt{
      display:flex;
      gap:10px;
      align-items:flex-start;
      padding:12px 12px;
      border:1px solid rgba(17,24,39,.08);
      border-radius:16px;
      background:rgba(255,255,255,.70);
    }
    .ic{
      width:28px; height:28px;
      border-radius:10px;
      background:rgba(249,115,22,.14);
      display:grid;
      place-items:center;
      flex:0 0 auto;
      color:var(--brand3);
      font-weight:900;
    }
    .pt b{ display:block; font-size:14px; margin-bottom:2px; }
    .pt small{ color:var(--muted2); line-height:1.45; font-size:13px; }

    .ctaRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    .btn{
      appearance:none;
      border:0;
      cursor:pointer;
      border-radius:14px;
      padding:12px 14px;
      font-weight:800;
      font-size:14px;
      letter-spacing:-0.01em;
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition: transform .06s ease, box-shadow .2s ease, background .2s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .btnPrimary{
      background: linear-gradient(135deg, var(--brand3), var(--brand));
      color:white;
      box-shadow: 0 18px 40px rgba(234,88,12,.22);
    }
    .btnPrimary:hover{
      box-shadow: 0 22px 55px rgba(234,88,12,.28);
    }
    .btnGhost{
      background:rgba(255,255,255,.85);
      border:1px solid rgba(17,24,39,.12);
      color:var(--text);
    }
    .btnGhost:hover{
      background:#fff;
    }
    .hint{
      color:var(--muted2);
      font-size:13px;
      margin-top:8px;
    }

    /* Right card (Pricing + Access) */
    .heroRight{
      padding:18px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .sectionTitle{
      font-weight:900;
      letter-spacing:-0.02em;
      margin:2px 0 6px;
      font-size:14px;
      color:var(--text);
    }
    .priceGrid{
      display:grid;
      gap:10px;
    }
    .priceCard{
      border:1px solid rgba(17,24,39,.10);
      border-radius:18px;
      background:rgba(255,255,255,.80);
      padding:14px;
    }
    .priceTop{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap:10px;
      margin-bottom:8px;
    }
    .priceTop b{
      font-size:14px;
      font-weight:900;
    }
    .tag{
      font-size:12px;
      font-weight:800;
      color:var(--chipText);
      background:var(--chip);
      border:1px solid rgba(249,115,22,.18);
      padding:6px 10px;
      border-radius:999px;
      white-space:nowrap;
    }
    .price{
      font-size:22px;
      font-weight:900;
      letter-spacing:-0.03em;
      margin:0 0 2px;
    }
    .per{
      margin:0;
      font-size:13px;
      color:var(--muted2);
      line-height:1.5;
    }

    .divider{
      height:1px;
      background:rgba(17,24,39,.08);
      margin:4px 0;
    }

    .accessBox{
      border:1px solid rgba(17,24,39,.10);
      border-radius:18px;
      background:rgba(255,255,255,.85);
      padding:14px;
    }
    .field{
      display:flex;
      gap:10px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    input[type="password"], input[type="text"]{
      flex: 1 1 180px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid rgba(17,24,39,.14);
      outline:none;
      font-size:14px;
      font-family:inherit;
      background:rgba(255,255,255,.95);
    }
    input:focus{
      border-color: rgba(249,115,22,.5);
      box-shadow: 0 0 0 4px rgba(249,115,22,.16);
    }
    .msg{
      margin-top:10px;
      font-size:13px;
      color:var(--muted);
      line-height:1.5;
      min-height: 18px;
    }
    .msg.ok{ color:#166534; }
    .msg.err{ color:#991b1b; }

    /* Modules */
    .modules{
      margin-top:18px;
      padding:18px 20px;
    }
    .modules h2{
      margin:0 0 10px;
      font-size:18px;
      letter-spacing:-0.03em;
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .chip{
      font-size:12.5px;
      font-weight:700;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(17,24,39,.10);
      background:rgba(255,255,255,.75);
      color:#1f2937;
    }
    .chip.more{
      background:rgba(249,115,22,.10);
      border-color: rgba(249,115,22,.18);
      color:#9a3412;
    }

    /* Footer */
    footer{
      margin-top:16px;
      padding:18px 6px 4px;
      color:var(--muted2);
      font-size:13px;
      line-height:1.6;
    }
    footer b{ color:var(--text); }
    .footGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media (max-width: 820px){
      .footGrid{ grid-template-columns: 1fr; }
    }
    .footCard{
      border:1px solid rgba(17,24,39,.08);
      border-radius:18px;
      background:rgba(255,255,255,.65);
      padding:14px;
    }
    .wa{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight:800;
      color:#065f46;
      background:rgba(16,185,129,.10);
      border:1px solid rgba(16,185,129,.18);
      padding:8px 10px;
      border-radius:999px;
      margin-top:8px;
    }
    .smallNote{
      margin-top:8px;
      font-size:12px;
      color:var(--muted2);
    }
  </style>
</head>

<body>
  <div class="wrap">

    <div class="top">
      <div class="brandRow">
        <!-- Ganti src ini sesuai lokasi file logo kamu -->
        <!-- Pastikan file logo disimpan misalnya di: /static/logo-aca-aol.png -->
        <img class="logo" src="/static/logo-aca-aol.png" alt="ACA-AOL Logo">
      </div>

      <div class="topRight">
        <div class="pill"><span class="dot"></span> Status: <strong id="authStatus">Checking‚Ä¶</strong></div>
        <a class="pill" href="tel:087884538950">üìû <strong>087884538950</strong></a>
        <a class="pill" target="_blank" rel="noopener" href="https://wa.me/6287884538950">üí¨ WhatsApp</a>
      </div>
    </div>

    <div class="hero">
      <section class="card heroLeft">
        <div class="badge"><span></span> Solusi cepat import data ke Accurate Online</div>

        <h1>
          Import Excel ke <span class="grad">Accurate Online</span><br/>
          lebih cepat, rapi, dan aman.
        </h1>

        <p class="sub">
          ACA-AOL membantu tim finance & admin memindahkan transaksi dari Excel ke Accurate Online tanpa input manual berulang.
          Cocok untuk implementasi awal, migrasi data, dan operasional harian.
        </p>

        <div class="points">
          <div class="pt">
            <div class="ic">‚úì</div>
            <div>
              <b>Template siap pakai</b>
              <small>Format kolom jelas, tinggal isi & upload.</small>
            </div>
          </div>
          <div class="pt">
            <div class="ic">‚ö°</div>
            <div>
              <b>Validasi sebelum kirim</b>
              <small>Deteksi error dulu biar minim gagal import.</small>
            </div>
          </div>
          <div class="pt">
            <div class="ic">üîí</div>
            <div>
              <b>Akses pakai kode</b>
              <small>Halaman import terkunci dengan access code.</small>
            </div>
          </div>
          <div class="pt">
            <div class="ic">üè¢</div>
            <div>
              <b>Siap multi-customer</b>
              <small>Subdomain untuk customer berlangganan.</small>
            </div>
          </div>
        </div>

        <div class="ctaRow">
          <button class="btn btnPrimary" id="btnLoginAccurate" type="button">
            üîê Login Accurate (OAuth)
          </button>
          <a class="btn btnGhost" href="#paket">
            üí≥ Lihat Paket & Harga
          </a>
          <a class="btn btnGhost" target="_blank" rel="noopener" href="https://wa.me/6287884538950?text=Halo%20ACA-AOL,%20saya%20mau%20tanya%20paket%20langganan%20dan%20modul.">
            üí¨ Konsultasi via WhatsApp
          </a>
        </div>
        <div class="hint">
          Setelah login Accurate, masukkan <b>kode akses</b> untuk membuka fitur import.
        </div>
      </section>

      <aside class="card heroRight" id="paket">
        <div>
          <div class="sectionTitle">Paket ACA-AOL</div>
          <div class="priceGrid">
            <div class="priceCard">
              <div class="priceTop">
                <b>Langganan 3 Bulan</b>
                <span class="tag">Per Modul</span>
              </div>
              <p class="price">Rp 450.000</p>
              <p class="per">1 modul / 3 bulan ‚Äî cocok untuk trial & kebutuhan periodik.</p>
            </div>

            <div class="priceCard">
              <div class="priceTop">
                <b>Langganan 1 Tahun</b>
                <span class="tag">Hemat</span>
              </div>
              <p class="price">Rp 1.250.000</p>
              <p class="per">1 modul / 1 tahun ‚Äî paling ekonomis untuk operasional rutin.</p>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="accessBox">
          <div class="sectionTitle">Masuk (Access Code)</div>
          <div style="font-size:13px;color:var(--muted2);line-height:1.5;">
            Masukkan kode akses untuk membuka endpoint import (API & halaman internal).
          </div>

          <div class="field">
            <input id="accessCode" type="password" placeholder="Masukkan kode akses‚Ä¶" autocomplete="one-time-code" />
            <button class="btn btnPrimary" id="btnVerify" type="button">Buka Akses</button>
          </div>

          <div id="msg" class="msg"></div>

          <div class="smallNote">
            Belum punya kode? Hubungi WhatsApp: <b>087884538950</b>
          </div>
        </div>
      </aside>
    </div>

    <section class="card modules">
      <h2>Modul yang tersedia</h2>
      <div class="chips">
        <span class="chip">Jurnal Voucher</span>
        <span class="chip">Payment</span>
        <span class="chip">Deposit</span>
        <span class="chip">Bank Transfer</span>
        <span class="chip">Sales Invoice</span>
        <span class="chip">Sales Receipt</span>
        <span class="chip">Sales Order</span>
        <span class="chip">Delivery Order</span>
        <span class="chip">Sales Return</span>
        <span class="chip">Purchase Order</span>
        <span class="chip">Receive Item</span>
        <span class="chip">Purchase Invoice</span>
        <span class="chip">Purchase Payment</span>
        <span class="chip">Purchase Return</span>
        <span class="chip">Item Transfer</span>
        <span class="chip">Item Adjustment</span>
        <span class="chip">Job Costing</span>
        <span class="chip more">dll.</span>
      </div>
    </section>

    <footer>
      <div class="footGrid">
        <div class="footCard">
          <b>Kontak</b><br>
          WhatsApp / Telepon: <span class="wa">üìû 087884538950</span><br>
          <div class="smallNote">Jam operasional mengikuti jam kantor.</div>
        </div>
        <div class="footCard">
          <b>Alamat Kantor</b><br>
          PT. Aneka Cipta Informasi Solusindo (ACIS Indonesia)<br>
          Ruko Viko Blok AX-05, The Green Court Lake Residence,<br>
          Cengkareng Timur, Cengkareng, Jakarta Barat
        </div>
      </div>
      <div class="smallNote" style="margin-top:10px;">
        ¬© <span id="year"></span> ACA-AOL ‚Äî Import Excel to Accurate Online.
      </div>
    </footer>
  </div>

<script>
  const $ = (id) => document.getElementById(id);

  function setMsg(text, type){
    const el = $("msg");
    el.textContent = text || "";
    el.className = "msg" + (type ? " " + type : "");
  }

  async function refreshAuthStatus(){
    try{
      const res = await fetch("/auth/status", { credentials: "include" });
      const data = await res.json();
      $("authStatus").textContent = data.access_ok ? "Akses Aktif" : "Belum Login";

      // OPTIONAL: kalau sudah akses aktif, langsung arahkan ke app
      if (data.access_ok && location.pathname === "/") {
        // kasih jeda kecil biar UI sempat update
        setTimeout(() => { window.location.href = "/app"; }, 200);
      }
    }catch(e){
      $("authStatus").textContent = "Unknown";
    }
  }

  $("btnLoginAccurate").addEventListener("click", () => {
    window.location.href = "/oauth/login";
  });

  $("btnVerify").addEventListener("click", async () => {
    setMsg("Memeriksa kode‚Ä¶");
    const code = ($("accessCode").value || "").trim();
    if(!code){
      setMsg("Kode akses masih kosong.", "err");
      return;
    }
    try{
      const res = await fetch("/auth/verify", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        credentials: "include",
        body: JSON.stringify({ code })
      });
      const data = await res.json();

      if(!res.ok || !data.ok){
        setMsg(data.error || "Gagal verifikasi kode.", "err");
        await refreshAuthStatus();
        return;
      }

      setMsg("Berhasil! Akses sudah aktif. Mengarahkan ke aplikasi‚Ä¶", "ok");
      await refreshAuthStatus();

      // INI YANG PENTING: redirect ke app
      setTimeout(() => { window.location.href = "/app"; }, 300);

    }catch(e){
      setMsg("Error koneksi. Coba ulang.", "err");
    }
  });

  $("year").textContent = new Date().getFullYear();
  refreshAuthStatus();
</script>

</body>
</html>
